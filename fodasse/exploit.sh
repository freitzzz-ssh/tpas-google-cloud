#!/bin/bash

if [ -f "exploit.b64" ]; then
    rm exploit.b64
fi

if [ -f "compressed_exploit.exe" ]; then
    rm compressed_exploit.exe
fi

if [[ ! "$1" == "" ]]
then
    exp="compressed_exploit.exe"
    gcc -static exploit.c -o exploit.exe
    upx --best exploit.exe -q -o $exp
else
    exp="exploit.exe"
    gcc exploit.c -o exploit.exe
fi

chmod +x $exp
cat $exp | base64 > exploit.b64
cat <(cat exploit.b64) - | nc tpas.alunos.dcc.fc.up.pt 5008
